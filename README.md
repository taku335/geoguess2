# Mini GeoGuessr-like

ブラウザで遊べるミニ GeoGuessr 風ゲームです。Google Street View から取得した 360° パノラマをもとに、表示された場所がどこかを世界地図上で推測してスコアを競います。PC やスマートフォンなど様々なデバイスで快適に遊べるよう UI を調整しています。

## 機能

- Google API キーなしでも遊べる、ウェブ上のオープンデータ 360° 画像(JPEG)を自動取得
- 20 件の候補リストを作成し、その中から 3 ラウンド分をランダムに出題
- Google Maps JavaScript API の Street View ビューア（ドラッグで視点移動、ホイール/ピンチでズーム）
- Leaflet ベースの推測用マップでタップ/クリックして位置を指定
- 推測地点と正解地点の距離に応じたスコア計算（最大 5000pt）
- 正解位置・距離・得点を表示する結果オーバーレイと軌跡ライン
- Google Maps Platform API キーの管理 UI（ローカルストレージに保存）
- 960px 未満では縦並びになるレスポンシブ UI、640px 未満ではタッチ操作向けのレイアウト

## 使い方

1. Google Cloud コンソールで Street View Static API / Maps JavaScript API が有効なプロジェクトを用意し、ブラウザキーを取得します。
2. `docs/index.html` をブラウザで開くか、簡易 HTTP サーバーを立ち上げます。
   ```bash
   # 例: Python の簡易サーバーを使う場合
   cd docs
   python -m http.server 8000
   ```
   その後 `http://localhost:8000/` にアクセスします。
3. Google Street View を利用したい場合は、画面右上の「Google APIキー (任意)」欄に Google Maps Platform の API キーを入力して「保存」します（ブラウザのローカルストレージに保存されます）。未入力でも内蔵のオープンデータ画像でプレイできます。
4. 「ゲーム開始」を押すと候補の取得が始まり、ラウンド 1 がスタートします。
5. ストリートビューを見ながら地図をクリック/タップして推測した位置をマークし、「この場所にする！」で回答します。
6. 結果パネルで距離と得点を確認し、「次のラウンド ▶」で進行します。3 ラウンド終えると合計スコアが表示されます。
7. いつでも「リスタート」でゲームをリセットできます。

## 開発メモ

- 主要ファイル
  - `docs/index.html`: 画面構造と外部リソースの読み込み
  - `docs/style.css`: レイアウトやテーマカラーを定義したスタイルシート
  - `docs/app.js`: ゲームロジックと Street View メタデータ取得処理
- Leaflet は CDN から読み込んでいます。オフライン対応が必要な場合はローカルにホストするか、バンドルしてください。
- Google Maps JavaScript API は動的に読み込みます。API キーは `localStorage` に保存され、`window.GOOGLE_MAPS_API_KEY` にも反映されます。API キーが未設定の場合は Photo Sphere Viewer を使ってオープンデータの 360° 画像を表示します。
- API キー未設定時に表示する 360° 画像は、Wikimedia Commons や ESO などの公開リポジトリからランタイムに取得した CC ライセンス素材 (JPEG のみ) を使用します。PNG 形式は利用しません。
- Street View の候補は世界各地の都市圏をランダムにサンプリングし、メタデータ API から取得しています。クォータ制限に注意してください。

## ライセンス

ソースコード部分は本リポジトリ作者のライセンスに従います。ゲーム内で利用するパノラマは Google Street View の利用規約に従ってください。
