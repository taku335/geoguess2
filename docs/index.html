<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mini GeoGuessr-like — 10候補版</title>

  <!-- Pannellum (360°パノラマ) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.css">
  <script src="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.js"></script>

  <!-- Leaflet (推測用マップ) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
          integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <div class="brand">🌍 Mini GeoGuessr-like</div>
    <div class="score">
      <div>ラウンド: <b id="roundLabel">0 / 3</b></div>
      <div>スコア: <b id="scoreLabel">0</b></div>
      <div>候補: <b id="poolLabel">0 / 10</b></div>
    </div>
    <div class="prefs">
      ラウンド数:
      <input id="roundsInput" type="number" min="1" max="10" value="3" disabled />
      <button id="startBtn" class="btn">ゲーム開始</button>
    </div>
  </header>

  <div class="layout">
    <div style="position: relative;">
      <div id="pano"></div>
      <div class="panel">パノラマ：ドラッグで見回す／スクロールでズーム</div>
      <div class="controls">
        <button id="guessBtn" class="btn success" disabled>この場所にする！</button>
        <button id="nextBtn"  class="btn secondary" disabled>次のラウンド ▶</button>
        <button id="resetBtn" class="btn warn">リスタート</button>
      </div>

      <!-- 結果 -->
      <div class="overlay" id="resultOverlay" aria-hidden="true">
        <div class="card">
          <h3 id="resultTitle">結果</h3>
          <div class="metric" style="margin: 8px 0 12px;">
            <div class="pill">距離 <span id="distLabel">—</span></div>
            <div class="pill">獲得 <span id="pointsLabel">—</span> pt</div>
          </div>
          <div style="color: var(--sub); margin-bottom: 8px;">
            正解：<b id="answerLabel">—</b><br/>
            <small id="creditLabel" style="color: var(--sub);"></small>
          </div>
          <button id="closeResult" class="btn">閉じる</button>
          <div class="footer-note">※ 線：推測地点→実際の地点</div>
        </div>
      </div>

      <!-- ローディング -->
      <div class="overlay" id="loadingOverlay" aria-hidden="true">
        <div class="card">
          <h3>Wikimedia から候補を収集中…</h3>
          <div class="loadingbar" style="margin: 8px 0 10px;"><div id="loadingBar"></div></div>
          <div id="loadingText" style="color: var(--sub);">準備中</div>
          <div style="margin-top:10px; color: var(--sub); font-size: 12px;">
            取得先カテゴリ：360° panoramas with equirectangular projection<br/>
            （座標付き・JPEGを抽出）
          </div>
        </div>
      </div>
    </div>

    <div id="map"></div>
  </div>

  <script src="app.js"></script>
</body>
</html>
